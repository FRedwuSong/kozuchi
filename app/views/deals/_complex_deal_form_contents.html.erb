  <div>
    <%= f.text_field :summary, :size => "40", :tabindex => '10' %>
  </div>

  <div>
    <%
      entry_types = [:debtor_entries, :creditor_entries]
      entry_types.reverse! unless current_user.preferences.bookkeeping_style?
      tab_index = 10 # わからない
    %>
    <div style="float:left;">
      <% if current_user.preferences.bookkeeping_style? %>
        <div>借方</div>
      <% end %>
      <% f.fields_for entry_types.first do |e| %>
        <% next if e.object.marked_for_destruction? %>
      <div>
        <div style="float:left;">
        <%= e.text_field :amount, :size => "8", :disabled => f.object.settlement_attached?, :class => 'amount', :tabindex => tab_index += 1 %>
        </div>
        <div style="float:left;">円</div>
        <div style="float:left;">
        <%= e.select :account_id, grouped_options_for_select(@user.accounts.grouped_options(entry_types.first == :creditor_entries), e.object.try(:account_id), ''), {}, :tabindex => (tab_index += 1) %>
        </div>
        <div style="clear:left;"></div>
      </div>
      <% end %>
    </div>
    <% unless current_user.preferences.bookkeeping_style? %>
      <div style="float:left; padding: 0 16px;">→</div>
    <% end %>
    <div style="float:left;">
      <% if current_user.preferences.bookkeeping_style? %>
        <div>貸方</div>
      <% end %>
      <% f.fields_for entry_types.last do |e| %>
        <% next if e.object.marked_for_destruction? %>
      <div>
        <div style="float:left;">
        <%= e.text_field :reversed_amount, :size => "8", :disabled => f.object.settlement_attached?, :class => 'amount', :tabindex => (tab_index += 1) %>
        </div>
        <div style="float:left;">円</div>
        <div style="float:left;">
        <%= e.select :account_id, grouped_options_for_select(@user.accounts.grouped_options(entry_types.last == :creditor_entries), e.object.try(:account_id), ''), {}, :tabindex => (tab_index += 1) %>
        </div>
        <div style="clear:left;"></div>
      </div>
      <% end %>
    </div>
    <div style="clear: left;"></div>
  </div>
  <div>
      <%= f.submit @deal.new_record? ? '記入' : '変更', :tablindex => "14", :class => 'button' %>
  </div>

  <%= javascript_tag <<-END
  function setEditDeal(summary, amount, minus_account_id, plus_account_id) {
  $('deal_debtor_entries_attributes_0_amount').value = amount;
  selectList('deal_creditor_entries_attributes_0_account_id', minus_account_id);
  selectList('deal_debtor_entries_attributes_0_account_id', plus_account_id);
  $('deal_summary').value = summary;
  }

  function selectList(name, value) {
  for (i = 0; i < $(name).options.length; i++) {
  if ($(name).options[i].value == value) {
  $(name).options.selectedIndex = i;
  return;
  }
  }
  }
  END
  %>